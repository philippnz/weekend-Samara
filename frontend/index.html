
<!doctype html><html lang="ru"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>Уикенд в Самаре</title><link rel="stylesheet" href="styles.css"></head><body>
<div class="app"><header class="header"><h1>Уикенд в Самаре</h1><p>2 дня · История · Волга</p></header>
<section id="summary" class="card">
  <img src="assets/samara.jpg" alt="Samara" class="hero">
  <div class="meta">
    <div>Бюджет: от <strong>3 500 ₽</strong></div>
    <button id="btnRoute" class="btn">Открыть маршрут</button>
    <button id="btnBuy" class="btn outline">Купить PDF-гид — 149 ₽</button>
  </div>
</section>
<section id="route" class="card hidden">
  <h2>День 1 — Центр и Волга</h2>
  <ul id="points"></ul>
  <div class="nav"><button id="back" class="btn outline">Назад</button></div>
</section>
</div>
<script src="https://telegram.org/js/telegram-web-app.js"></script>
<script>
const tg = window.Telegram && window.Telegram.WebApp; if(tg) tg.expand();
async function loadRoute(){
  const res = await fetch('/api/routes/1'); if(!res.ok) return;
  const r = await res.json();
  document.getElementById('points').innerHTML = r.points.map(p=>`
    <li class="point"><h3>${p.title}</h3><p>${p.description}</p>
      <div class="actions"><a class="btn outline" href="https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(p.title + ', Самара')}" target="_blank">Открыть в карте</a></div>
    </li>`).join('');
  document.getElementById('summary').classList.add('hidden'); document.getElementById('route').classList.remove('hidden');
}
document.getElementById('btnRoute').addEventListener('click', loadRoute);
document.getElementById('back').addEventListener('click', ()=>{ document.getElementById('summary').classList.remove('hidden'); document.getElementById('route').classList.add('hidden'); });
document.getElementById('btnBuy').addEventListener('click', async ()=>{
  const resp = await fetch('/api/orders', {method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify({route_id:1, name:'Anon', contact:'tg', amount:149})});
  const j = await resp.json(); alert('Заказ создан: ' + j.id + '. Добавьте платежную систему для оплаты.');
});
</script>
</body></html>
